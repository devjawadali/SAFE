# Mobile App Connection
# ====================
# The mobile app needs to connect to this backend server for API and Socket.io communication.
#
# Mobile App Configuration:
# - Mobile app configuration is located at: mobile/SafeRide-Mobile/config/app.config.js
# - Update the mobile app's development IP address to match your computer's local IP address
#
# Finding Your IP Address:
# - Windows: Run ipconfig command, look for "IPv4 Address" under your WiFi adapter
# - macOS/Linux: Run ifconfig | grep "inet " or hostname -I command
#
# Important:
# - Mobile device and computer must be on the same WiFi network for development
# - The PORT below must match the port in mobile app config (default: 4000)
# - For detailed mobile app setup, see mobile/SafeRide-Mobile/README.md

# Server Configuration
PORT=4000                    # Server port (must match port in mobile app config)
NODE_ENV=development         # Environment mode

# Database Configuration
# ====================
# PostgreSQL connection parameters (required for backend to start)
#
# For local development:
# - Install PostgreSQL 16+ from https://www.postgresql.org/download/
# - Create database: psql -U postgres -c "CREATE DATABASE saferide;"
# - Set DB_PASSWORD to your PostgreSQL password
#
# For cloud deployment (Heroku, Supabase, etc.):
# - Use DATABASE_URL instead of individual DB_* variables
# - Example: DATABASE_URL=postgresql://user:password@host:port/database

DB_HOST=localhost            # Database server hostname
DB_PORT=5432                 # PostgreSQL port (default: 5432)
DB_NAME=saferide             # Database name (must match created database)
DB_USER=postgres             # PostgreSQL username
DB_PASSWORD=                 # Your PostgreSQL password (REQUIRED - do not leave empty)
DB_SSL=false                 # SSL mode (false for local, true for production)

# Alternative: Use DATABASE_URL for cloud databases (takes precedence over DB_* variables)
# DATABASE_URL=postgresql://user:password@host:port/database

# Authentication
JWT_SECRET=your-secret-key-change-in-production-2024  # JWT signing key (MUST CHANGE - see below)

# IMPORTANT: Generate a strong JWT secret for security
# Method 1 (Recommended): node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# Method 2: openssl rand -hex 64
# The secret should be at least 64 characters long and cryptographically random
# Never use the placeholder value above in production!
JWT_EXPIRES_IN=7d           # Token validity (7 days)
OTP_EXPIRY=300              # OTP expiration (seconds)

# Security
# CORS_ORIGIN: Controls which origins can access the API
# - For development: Use * to allow all origins (convenient for mobile app testing)
# - For production: Specify exact mobile app origins (comma-separated)
# Example for production: CORS_ORIGIN=http://localhost:19000,http://192.168.100.254:19000
CORS_ORIGIN=*

# Socket.io (Optional)
SOCKET_TRANSPORTS=websocket,polling

# Optional Configuration
# ====================
# These variables have sensible defaults but can be customized

# Error Tracking (Optional)
SENTRY_DSN=                  # Sentry DSN for error tracking (leave empty to disable)

# Token Configuration (Optional - has defaults in tokenService.js)
ACCESS_TOKEN_EXPIRY=30m      # Short-lived access token expiry (default: 30 minutes)
REFRESH_TOKEN_EXPIRY_DAYS=7  # Refresh token validity (default: 7 days)

# Rate Limiting (Optional - has defaults in rateLimit.js)
RATE_LIMIT_WINDOW_MS=900000  # Rate limit window in milliseconds (default: 15 minutes)

# Troubleshooting
# ====================
#
# Backend crashes on startup:
# - Ensure PostgreSQL is installed and running (services.msc on Windows)
# - Verify database 'saferide' exists: psql -U postgres -c "\l"
# - Check DB_PASSWORD matches your PostgreSQL password
# - Test connection: psql -h localhost -p 5432 -U postgres -d saferide
#
# "password authentication failed" error:
# - DB_PASSWORD is incorrect or empty
# - Reset password: See README.md for password reset instructions
#
# "database does not exist" error:
# - Create database: psql -U postgres -c "CREATE DATABASE saferide;"
# - Run schema: psql -U postgres -d saferide -f db/schema.sql
#
# Mobile app can't connect (404/connection errors):
# - Ensure backend is running (npm start)
# - Check mobile app's API_BASE_URL matches your IP and PORT
# - Verify both devices are on the same WiFi network
# - Check firewall isn't blocking port 4000
#
# For more help, see:
# - README.md for setup instructions
# - SETUP_GUIDE.md for detailed configuration
# - ARCHITECTURE.md for system overview
